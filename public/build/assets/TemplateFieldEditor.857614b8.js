import{_ as a,s as m}from"./vendor.c4aed689.js";import{d as u}from"./vuedraggable.umd.67d6b640.js";import{C as c}from"./CheckboxGroup.1fa9c6b8.js";import{I as n}from"./InputGroup.a917a486.js";import{n as s}from"./LogoLight.7b23342e.js";import{S as o}from"./app.673a3b5a.js";const d={model:{prop:"fieldSettings"},props:{defaultSettings:{required:!0,type:Array|Object},fieldSettings:{required:!0,type:Array|Object},templateField:{required:!0,type:Object}},data(){return{editableFieldSettings:{}}},computed:{isDefaultSettings(){try{return!this.defaultSettings||Array.isArray(this.defaultSettings)?!1:Object.keys(this.defaultSettings).length}catch{return!1}}},mounted(){this.editableFieldSettings=a.cloneDeep(this.fieldSettings),this.initialiseSettings()},methods:{initialiseSettings(){(!this.editableFieldSettings||Array.isArray(this.editableFieldSettings))&&(this.editableFieldSettings={}),this.isDefaultSettings&&a.forEach(this.defaultSettings,(l,e)=>{this.editableFieldSettings.hasOwnProperty(e)||(this.editableFieldSettings[e]=l)})},onEditableSettingsChange(){this.$emit("input",this.editableFieldSettings)},onFieldSettingsChange(){this.editableFieldSettings=a.cloneDeep(this.fieldSettings)}},watch:{fieldSettings:{handler:"onFieldSettingsChange"}}},g={name:"TemplateFieldNumberSettings",mixins:[d],components:{InputGroup:n}};var f=function(){var e=this,t=e._self._c;return t("div",[e._t("default"),t("div",{staticClass:"flex flex-col md:flex-row md:space-x-4"},[t("input-group",{staticClass:"flex-1 mt-4",attrs:{"input-id":`template-field-${e.templateField.order}-min`,"input-name":`template-field-${e.templateField.order}-min`,"input-type":"number","label-text":"Minimum Value"},on:{input:e.onEditableSettingsChange},model:{value:e.editableFieldSettings.min,callback:function(i){e.$set(e.editableFieldSettings,"min",i)},expression:"editableFieldSettings.min"}}),t("input-group",{staticClass:"flex-1 mt-4",attrs:{"input-id":`template-field-${e.templateField.order}-max`,"input-name":`template-field-${e.templateField.order}-max`,"input-type":"number","label-text":"Maximum Value"},on:{input:e.onEditableSettingsChange},model:{value:e.editableFieldSettings.max,callback:function(i){e.$set(e.editableFieldSettings,"max",i)},expression:"editableFieldSettings.max"}})],1)],2)},b=[],F=s(g,f,b,!1,null,null,null,null);const h=F.exports,T={name:"TemplateFieldRepeaterSettings",mixins:[d],components:{SelectGroup:o},data(){return{isLoadingTemplates:!1,repeaterTemplates:null}},computed:{repeaterTemplateOptions(){let l={"":"No templates available"};try{return!this.repeaterTemplates||!this.repeaterTemplates.length?l:this.repeaterTemplates}catch{return l}}},mounted(){this.getRepeaterTemplates()},methods:{getRepeaterTemplates(){this.isLoadingTemplates=!0,axios.get(this.$route("admin.api.cms.templates.index"),{params:{template_type:"repeater"}}).then(l=>{this.repeaterTemplates=l.data.data}).catch(l=>{this.$errorToast("Failed to load selected template"),console.log(l)}).finally(()=>{this.isLoadingTemplates=!1})}}};var x=function(){var e=this,t=e._self._c;return t("div",[e._t("default"),e.isLoadingTemplates?t("div",{staticClass:"flex flex-row items-start mt-4 text-theme-base-subtle-contrast w-full"},[t("icon-loader-circle",{staticClass:"animate-spin-slow mr-2 w-5"}),t("span",{staticClass:"text-left"},[e._v("Loading")])],1):t("select-group",{staticClass:"mt-4",attrs:{"input-any-option-enabled":!0,"input-any-option-label":"Please select a template","input-option-force-formatting":!0,"input-option-label-key":"name","input-option-value-key":"id","input-id":`template-field-${e.templateField.order}-template-id`,"input-name":`template-field-${e.templateField.order}-template-id`,"input-options":e.repeaterTemplateOptions,"input-required":!0,"label-text":"Repeater Template"},on:{input:e.onEditableSettingsChange},model:{value:e.editableFieldSettings.template_id,callback:function(i){e.$set(e.editableFieldSettings,"template_id",i)},expression:"editableFieldSettings.template_id"}})],2)},y=[],S=s(T,x,y,!1,null,null,null,null);const v=S.exports,$={name:"TemplateFieldTextAreaSettings",mixins:[d],components:{InputGroup:n}};var C=function(){var e=this,t=e._self._c;return t("div",[e._t("default"),t("div",{staticClass:"flex flex-col md:flex-row md:space-x-4"},[t("input-group",{staticClass:"flex-1 mt-4",attrs:{"input-id":`template-field-${e.templateField.order}-max-length`,"input-name":`template-field-${e.templateField.order}-max-length`,"input-type":"number","label-text":"Max Length"},on:{input:e.onEditableSettingsChange},model:{value:e.editableFieldSettings.max_length,callback:function(i){e.$set(e.editableFieldSettings,"max_length",i)},expression:"editableFieldSettings.max_length"}}),t("input-group",{staticClass:"flex-1 mt-4",attrs:{"input-id":`template-field-${e.templateField.order}-rows`,"input-name":`template-field-${e.templateField.order}-rows`,"input-type":"text","label-text":"Rows"},on:{input:e.onEditableSettingsChange},model:{value:e.editableFieldSettings.rows,callback:function(i){e.$set(e.editableFieldSettings,"rows",i)},expression:"editableFieldSettings.rows"}})],1)],2)},w=[],E=s($,C,w,!1,null,null,null,null);const D=E.exports,k={name:"TemplateFieldTextSettings",mixins:[d],components:{InputGroup:n}};var M=function(){var e=this,t=e._self._c;return t("div",[e._t("default"),t("input-group",{staticClass:"mt-4",attrs:{"input-id":`template-field-${e.templateField.order}-max-length`,"input-name":`template-field-${e.templateField.order}-max-length`,"input-type":"number","label-text":"Max Length"},on:{input:e.onEditableSettingsChange},model:{value:e.editableFieldSettings.max_length,callback:function(i){e.$set(e.editableFieldSettings,"max_length",i)},expression:"editableFieldSettings.max_length"}})],2)},q=[],O=s(k,M,q,!1,null,null,null,null);const A=O.exports,R={name:"TemplateField",components:{CheckboxGroup:c,InputGroup:n,NumberSettings:h,RepeaterSettings:v,SelectGroup:o,TextAreaSettings:D,TextSettings:A},model:{prop:"templateField"},props:{errorMessageKeyPrefix:{default:"templateFields",type:String},isAutofocusDisabled:{default:!1,type:Boolean},isViewOnly:{default:!1,type:Boolean},templateField:{required:!0,type:Object},templateFieldSettings:{required:!0,type:Object},templateFieldTypes:{required:!0,type:Object}},data(){return{autoUpdateSlug:!0,editableTemplateField:{description:"",is_required:!1,name:"",order:0,settings:{},slug:"",type:""}}},computed:{defaultFieldSettings(){if(!this.editableTemplateField.type)return!1;try{return this.templateFieldSettings[this.editableTemplateField.type]}catch{return{}}},errorMessageKey(){return this.errorMessageKeyPrefix+"."+this.editableTemplateField.order+"."},settingsComponent(){if(!this.editableTemplateField.type)return!1;switch(this.editableTemplateField.type){case"number":return"number-settings";case"repeater":return"repeater-settings";case"text":return"text-settings";case"textarea":return"text-area-settings";default:return!1}}},created(){this.editableTemplateField=_.cloneDeep(this.templateField),this.editableTemplateField.slug&&this.editableTemplateField.slug!==""&&(this.autoUpdateSlug=!1)},methods:{clearErrorMessage(l){this.clearPageErrorMessage(this.errorMessageKey+l)},getErrorMessage(l){let e=this.getPageErrorMessage(this.errorMessageKey+l);return e=e.replace(this.errorMessageKey,""),e},onNameInput(){if(!this.autoUpdateSlug){this.updateTemplateField();return}this.editableTemplateField.slug=this.slugify(this.editableTemplateField.name),this.updateTemplateField()},onSlugBlur(){this.editableTemplateField.slug=this.slugify(this.editableTemplateField.slug),this.updateTemplateField()},onSlugInput(){this.autoUpdateSlug=!1},onTemplateFieldUpdate(){this.editableTemplateField=_.cloneDeep(this.templateField)},slugify(l){return!l||!l.length?"":m(l,{lower:!0})},updateTemplateField(){this.$emit("input",_.cloneDeep(this.editableTemplateField))}},watch:{templateField:{deep:!0,handler:"onTemplateFieldUpdate"}}};var j=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"flex flex-col md:flex-row md:space-x-4"},[t("select-group",{staticClass:"flex-1",attrs:{"error-message":e.getErrorMessage("type"),"label-text":"Field Type","input-any-option-enabled":!0,"input-any-option-label":"Please select a field type","input-autofocus":!e.isAutofocusDisabled,"input-id":`template-field-${e.templateField.order}-type`,"input-name":`template-field-${e.templateField.order}-type`,"input-options":e.templateFieldTypes,"input-required":!0},on:{errorHidden:function(i){return e.clearErrorMessage("type")},input:e.updateTemplateField},model:{value:e.editableTemplateField.type,callback:function(i){e.$set(e.editableTemplateField,"type",i)},expression:"editableTemplateField.type"}}),t("input-group",{staticClass:"flex-1 mt-4 md:mt-0",attrs:{"input-disabled":!0,"input-id":`template-field-${e.templateField.order}-order`,"input-name":`template-field-${e.templateField.order}-order`,"input-type":"number","label-text":"Order"},on:{input:e.updateTemplateField},model:{value:e.editableTemplateField.order,callback:function(i){e.$set(e.editableTemplateField,"order",i)},expression:"editableTemplateField.order"}})],1),t("div",{staticClass:"flex flex-col md:flex-row md:space-x-4"},[t("input-group",{staticClass:"flex-1 mt-4",attrs:{"error-message":e.getErrorMessage("name"),"input-id":`template-field-${e.templateField.order}-name`,"input-name":`template-field-${e.templateField.order}-name`,"input-required":!0,"input-type":"text","label-text":"Field Name"},on:{errorHidden:function(i){return e.clearErrorMessage("name")},input:e.onNameInput},model:{value:e.editableTemplateField.name,callback:function(i){e.$set(e.editableTemplateField,"name",i)},expression:"editableTemplateField.name"}}),t("input-group",{staticClass:"flex-1 mt-4",attrs:{"error-message":e.getErrorMessage("slug"),"input-id":`template-field-${e.templateField.order}-slug`,"input-name":`template-field-${e.templateField.order}-slug`,"input-required":!0,"input-type":"text","label-text":"Field Slug"},on:{blur:e.onSlugBlur,errorHidden:function(i){return e.clearErrorMessage("slug")},input:e.onSlugInput},model:{value:e.editableTemplateField.slug,callback:function(i){e.$set(e.editableTemplateField,"slug",i)},expression:"editableTemplateField.slug"}})],1),t("input-group",{staticClass:"mt-4",attrs:{"error-message":e.getErrorMessage("description"),"input-id":`template-field-${e.templateField.order}-description`,"input-name":`template-field-${e.templateField.order}-description`,"input-type":"text","label-text":"Description"},on:{errorHidden:function(i){return e.clearErrorMessage("description")},input:e.updateTemplateField},model:{value:e.editableTemplateField.description,callback:function(i){e.$set(e.editableTemplateField,"description",i)},expression:"editableTemplateField.description"}}),t("checkbox-group",{staticClass:"mt-4",attrs:{"error-message":e.getErrorMessage("is_required"),"input-id":`template-field-${e.templateField.order}-is_required`,"input-name":`template-field-${e.templateField.order}-is_required`,"label-text":"Required?"},on:{errorHidden:function(i){return e.clearErrorMessage("is_required")},input:e.updateTemplateField},model:{value:e.editableTemplateField.is_required,callback:function(i){e.$set(e.editableTemplateField,"is_required",i)},expression:"editableTemplateField.is_required"}}),e.settingsComponent?t(e.settingsComponent,{tag:"component",attrs:{"default-settings":e.defaultFieldSettings,"template-field":e.editableTemplateField},on:{input:e.updateTemplateField},model:{value:e.editableTemplateField.settings,callback:function(i){e.$set(e.editableTemplateField,"settings",i)},expression:"editableTemplateField.settings"}},[t("p",{staticClass:"font-semibold mt-6 text-theme-base-subtle-contrast"},[e._v(" Settings ")])]):e._e()],1)},K=[],N=s(R,j,K,!1,null,null,null,null);const L=N.exports;const P={name:"TemplateFieldEditor",components:{draggable:u,TemplateField:L},model:{prop:"templateFields"},props:{isEditing:{default:!1,type:Boolean},isViewOnly:{default:!1,type:Boolean},templateFieldSettings:{required:!0,type:Object},templateFieldTypes:{required:!0,type:Object},templateFields:{required:!0,type:Array}},data(){return{editableTemplateFields:[],isAutofocusDisabled:!1,isDragging:!1}},created(){this.isEditing&&(this.isAutofocusDisabled=!0),this.editableTemplateFields=a.cloneDeep(this.templateFields)},methods:{addTemplateField(){this.isAutofocusDisabled=!1,this.editableTemplateFields.push({description:"",is_required:!1,name:"",order:this.templateFields.length,settings:{},slug:"",type:""}),this.updateTemplateFields()},deleteTemplateField(l){try{this.editableTemplateFields.splice(l,1),this.reorderTemplateFields()}catch(e){this.$errorToast("Failed to delete field"),console.log(e)}},getTemplateFieldTypesKeys(){try{return Object.keys(this.templateFieldTypes)}catch{return[]}},onDraggableEnd(){this.isDragging=!1,this.reorderTemplateFields()},onDraggableSort(){this.$page.props.errors={}},onDraggableStart(){this.isDragging=!0},onTemplateFieldsChange(l){this.editableTemplateFields=a.cloneDeep(l)},onTemplateFieldTypesChange(){try{let l=this.getTemplateFieldTypesKeys();a.forEach(this.editableTemplateFields,(e,t)=>{e.type&&l.indexOf(e.type)<0&&(this.editableTemplateFields[t].type="")}),this.updateTemplateFields()}catch(l){console.log(l)}},reorderTemplateFields(){try{if(!this.editableTemplateFields.length){this.updateTemplateFields();return}this.editableTemplateFields.forEach((l,e)=>{this.editableTemplateFields[e].order=e}),this.updateTemplateFields()}catch(l){throw"Failed to reorder fields: "+l}},updateTemplateFields(){this.$emit("input",a.cloneDeep(this.editableTemplateFields))}},watch:{templateFields:{handler:"onTemplateFieldsChange"},templateFieldTypes:{handler:"onTemplateFieldTypesChange",deep:!0}}};var B=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"flex flex-row items-center"},[t("span",{staticClass:"text-lg"},[e._v("Template Fields")]),t("button",{staticClass:"button button-primary-subtle button-small ml-auto text-sm",attrs:{type:"button"},on:{click:e.addTemplateField}},[e._v(" Add Field ")])]),e.editableTemplateFields.length?[t("draggable",{staticClass:"mt-6",attrs:{animation:200,disabled:e.isViewOnly,"ghost-class":"ghost",handle:".draggable-handle"},on:{end:e.onDraggableEnd,sort:e.onDraggableSort,start:e.onDraggableStart},model:{value:e.editableTemplateFields,callback:function(i){e.editableTemplateFields=i},expression:"editableTemplateFields"}},[t("transition-group",{attrs:{name:e.isDragging?null:"flip-field",type:"transition"}},e._l(e.editableTemplateFields,function(i,r){return t("article",{key:`template-field-${r}`,staticClass:"border-2 border-theme-base-subtle mt-4 overflow-hidden rounded"},[t("header",{staticClass:"draggable-handle bg-theme-base-subtle cursor-move flex flex-row items-center px-4 py-3"},[t("icon-grid-dots",{staticClass:"w-5"}),t("span",{staticClass:"flex-1 pl-4"},[i.name&&i.name.length?[e._v(" "+e._s(i.name)+" ")]:[e._v(" New Template Field ")]],2)],1),t("p",{staticClass:"p-4"},[t("template-field",{attrs:{"is-autofocus-disabled":e.isAutofocusDisabled,"template-field-types":e.templateFieldTypes,"template-field-settings":e.templateFieldSettings},on:{input:e.updateTemplateFields},model:{value:e.editableTemplateFields[r],callback:function(p){e.$set(e.editableTemplateFields,r,p)},expression:"editableTemplateFields[index]"}})],1),t("footer",{staticClass:"flex flex-row items-center px-4 py-3"},[t("button",{staticClass:"button button-small bg-transparent border border-theme-base-subtle-contrast flex flex-row items-center ml-auto text-sm text-theme-base-subtle-contrast hover:bg-theme-danger-contrast hover:text-theme-danger hover:border-theme-danger-contrast",attrs:{type:"button"},on:{click:function(p){return e.deleteTemplateField(r)}}},[t("icon-trash",{staticClass:"h-4 w-4"}),t("span",{staticClass:"pl-2"},[e._v("Delete")])],1)])])}),0)],1),t("div",{staticClass:"flex flex-row items-center mt-6"},[t("button",{staticClass:"button button-primary-subtle button-small ml-auto text-sm",attrs:{type:"button"},on:{click:e.addTemplateField}},[e._v(" Add Field ")])])]:t("p",{staticClass:"bg-theme-base-subtle mt-6 px-4 py-3 rounded text-center text-theme-base-subtle-contrast"},[e._v(" No template fields ")])],2)},I=[],U=s(P,B,I,!1,null,"d2f9043c",null,null);const W=U.exports;export{W as T};
