import{_ as a,O as o}from"./vendor.d799578a.js";import{C as s}from"./ConfirmationModal.02c27389.js";import{I as r}from"./InputGroup.23900402.js";import{S as l}from"./app.267c68cc.js";import{n as u}from"./LogoLight.dd39b68d.js";const c={name:"AdminCrmOrganisationUnitIndex",components:{ConfirmationModal:s,InputGroup:r,SelectGroup:l},layout:"admin-layout",props:{searchOptions:{required:!0,type:Array|Object},organisationUnits:{required:!0,type:Object},organisationUnitTypes:{required:!0,type:Object}},data(){return{editableSearchOptions:{organisation_unit_email:"",organisation_unit_name:"",organisation_unit_telephone:"",organisation_unit_type:"",per_page:15},isInitialised:!1,isLoadingDelete:!1,showDeleteModal:!1,organisationUnitToDelete:null}},computed:{organisationUnitsData(){return!this.organisationUnits||!this.organisationUnits.data||this.organisationUnits.data.length<1?!1:this.organisationUnits.data},deleteModalText(){try{return"Do you really want to delete '"+this.organisationUnitToDelete.name+"'?"}catch{return"Do you really want to delete this organisation unit?"}},showOrganisationUnitActions(){return this.userCan("crm_organisation_units.edit")||this.userCan("crm_organisation_units.delete")},showPagination(){try{return this.organisationUnits.pagination.last_page>1}catch{return!1}}},mounted(){this.setSearchOptions(this.searchOptions)},methods:{cancelDelete(){this.isLoadingDelete||(this.showDeleteModal=!1,this.organisationUnitToDelete=null)},checkDelete(n){this.showDeleteModal=!0,this.organisationUnitToDelete=n},confirmDelete(){if(this.isLoadingDelete)return this.$errorToast("It's only possible to delete one organisation unit at a time.");this.$inertia.delete(this.$route("admin.crm.organisation-units.destroy",this.organisationUnitToDelete.id),{only:["flash","organisationUnits"]}),this.organisationUnitToDelete=null,this.showDeleteModal=!1},onSearchOptionsUpdate:a.debounce(function(){!this.isInitialised&&(this.isInitialised=!0,this.organisationUnitsData)||o.get(this.$route("admin.crm.organisation-units.index"),this.editableSearchOptions,{only:["organisationUnits"],preserveState:!0})},500),setSearchOptions(n={}){let t={organisation_unit_email:"",organisation_unit_name:"",organisation_unit_telephone:"",organisation_unit_type:"",per_page:15};try{a.forEach(n,(e,i)=>{t[i]=e})}catch(e){console.log(e)}this.editableSearchOptions=a.cloneDeep(t)}},watch:{editableSearchOptions:{deep:!0,handler:"onSearchOptionsUpdate"}}};var p=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"flex flex-row items-center mb-6"},[e("h1",{staticClass:"font-medium mr-auto text-lg"},[t._v(" Organisation Units ")]),t.userCan("crm_organisation_units.create")?e("inertia-link",{staticClass:"button button-default-responsive button-primary flex flex-row items-center",attrs:{href:t.$route("admin.crm.organisation-units.create")}},[e("icon-plus",{staticClass:"w-5 md:mr-2"}),e("span",{staticClass:"hidden md:inline"},[t._v(" Create Organisation Unit ")])],1):t._e()],1),e("div",{staticClass:"bg-white py-6 shadow-subtle rounded-lg"},[e("h1",{staticClass:"font-semibold px-6 text-gray-850"},[t._v(" Search "),e("button",{staticClass:"text-sm text-theme-base-subtle-contrast focus:outline-none focus:text-theme-primary hover:text-theme-primary",on:{click:t.setSearchOptions}},[t._v(" (Clear) ")])]),e("div",{staticClass:"flex flex-col items-center mt-4 px-6 space-y-4 md:flex-row md:space-y-0 md:space-x-8"},[e("div",{staticClass:"w-full md:w-1/4"},[e("select-group",{staticClass:"mx-4",attrs:{"label-hidden":!0,"label-text":"Type","input-any-option-enabled":!0,"input-any-option-label":"Type","input-class":"form-control form-control-short","input-id":"organisation_unit_type","input-name":"organisation_unit_type","input-options":t.organisationUnitTypes},model:{value:t.editableSearchOptions.organisation_unit_type,callback:function(i){t.$set(t.editableSearchOptions,"organisation_unit_type",i)},expression:"editableSearchOptions.organisation_unit_type"}})],1),e("div",{staticClass:"w-full md:w-1/4"},[e("input-group",{attrs:{"input-autocomplete":"organisation_unit_name_search","input-class":"form-control form-control-short","input-id":"organisation_unit_name","input-name":"organisation_unit_name","input-placeholder":"Name","input-type":"text","label-hidden":!0,"label-text":"Name"},model:{value:t.editableSearchOptions.organisation_unit_name,callback:function(i){t.$set(t.editableSearchOptions,"organisation_unit_name",i)},expression:"editableSearchOptions.organisation_unit_name"}})],1),e("div",{staticClass:"w-full md:w-1/4"},[e("input-group",{attrs:{"input-autocomplete":"organisation_unit_email","input-class":"form-control form-control-short","input-id":"organisation_unit_email","input-name":"organisation_unit_email","input-placeholder":"Email","input-type":"text","label-hidden":!0,"label-text":"Email"},model:{value:t.editableSearchOptions.organisation_unit_email,callback:function(i){t.$set(t.editableSearchOptions,"organisation_unit_email",i)},expression:"editableSearchOptions.organisation_unit_email"}})],1),e("div",{staticClass:"w-full md:w-1/4"},[e("input-group",{attrs:{"input-autocomplete":"organisation_unit_telephone_search","input-class":"form-control form-control-short","input-id":"organisation_unit_telephone","input-name":"organisation_unit_telephone","input-placeholder":"Telephone","input-type":"text","label-hidden":!0,"label-text":"Telephone"},model:{value:t.editableSearchOptions.organisation_unit_telephone,callback:function(i){t.$set(t.editableSearchOptions,"organisation_unit_telephone",i)},expression:"editableSearchOptions.organisation_unit_telephone"}})],1)]),t.organisationUnitsData?[e("div",{staticClass:"block mt-8 overflow-x-auto w-full"},[e("table",{staticClass:"table table-hover table-striped w-full"},[e("thead",[e("tr",[e("th",[t._v("Type")]),e("th",[t._v("Name")]),e("th",[t._v("Email")]),e("th",[t._v("Telephone")]),t.showOrganisationUnitActions?e("th"):t._e()])]),e("tbody",t._l(t.organisationUnitsData,function(i,h){return e("tr",{key:`organisation-unit-${i.slug}`},[e("td",[t._v(" "+t._s(t.organisationUnitTypes[i.type])+" ")]),e("td",[t._v(" "+t._s(i.name)+" ")]),e("td",[t._v(" "+t._s(i.email)+" ")]),e("td",[t._v(" "+t._s(i.telephone)+" ")]),t.showOrganisationUnitActions?e("td",[e("div",{staticClass:"flex flex-row items-center justify-end -mx-1"},[t.userCan("crm_organisation_units.edit")?e("inertia-link",{staticClass:"flex flex-row items-center inline-flex mx-1 px-2 py-1 rounded text-theme-base-subtle-contrast text-sm tracking-wide focus:outline-none focus:ring hover:bg-theme-info hover:text-theme-info-contrast",attrs:{href:t.$route("admin.crm.organisation-units.edit",i.id),title:"Edit Organisation Unit"}},[e("icon-edit",{staticClass:"w-4"})],1):t._e(),t.userCan("crm_organisation_units.delete")?e("button",{staticClass:"flex flex-row items-center inline-flex mx-1 px-2 py-1 rounded text-theme-base-subtle-contrast text-sm tracking-wide focus:outline-none focus:ring hover:bg-theme-danger hover:text-theme-danger-contrast",attrs:{title:"Delete Organisation Unit"},on:{click:function(_){return t.checkDelete(i)}}},[e("icon-trash",{staticClass:"w-4"})],1):t._e()],1)]):t._e()])}),0)])])]:e("p",{staticClass:"bg-theme-base-subtle mt-6 mx-6 px-6 py-4 rounded text-center text-theme-base-subtle-contrast"},[t._v(" No organisation units ")]),t.showPagination?e("div",{staticClass:"flex flex-row justify-center mt-12 px-6"},[e("pagination",{attrs:{pagination:t.organisationUnits.pagination}})],1):t._e(),e("confirmation-modal",{attrs:{"confirm-text":"Delete","confirm-type":"danger","show-modal":t.showDeleteModal,"message-text":t.deleteModalText},on:{cancelAction:t.cancelDelete,closeModal:t.cancelDelete,confirmAction:t.confirmDelete}})],2)])},d=[],m=u(c,p,d,!1,null,null,null,null);const v=m.exports;export{v as default};
