import{I as i}from"./InlineCheckboxGroup.3c691ce1.js";import{I as s}from"./InputGroup.a917a486.js";import{C as l}from"./ConfirmationModal.944b592f.js";import{G as d}from"./GenericModal.c7d671f7.js";import"./vendor.c4aed689.js";import{n as r}from"./LogoLight.7b23342e.js";import"./checkbox-form-group.50e62bcf.js";const m={name:"AdminTenantEdit",components:{GenericModal:d,ConfirmationModal:l,InlineCheckboxGroup:i,InputGroup:s},layout:"admin-layout",props:{tenant:{required:!0,type:Object}},data(){return{domainData:null,domainIndexToDelete:null,formData:null,isLoadingDomain:!1,showAddDomainModal:!1,showDeleteDomainModal:!1}},computed:{deleteDomainModalText(){try{return"Do you really want to delete '"+this.domainToDelete.domain+"'?"}catch{return"Do you really want to delete this domain?"}},domainToDelete(){try{return this.tenant.domains[this.domainIndexToDelete]}catch{return null}}},created(){this.formData={id:this.tenant.id}},methods:{addDomain(){this.domainData={domain:""},this.showAddDomainModal=!0},cancelDomainDelete(){this.isLoadingDomain||(this.showDeleteDomainModal=!1,this.domainIndexToDelete=null)},checkDomainDelete(n){this.domainIndexToDelete=n,this.showDeleteDomainModal=!0},closeAddDomainModal(){this.isLoadingDomain||(this.showAddDomainModal=!1)},confirmDomainDelete(){if(this.isLoadingDomain)return this.$errorToast("It's only possible to delete one domain at a time.");if(!this.domainToDelete)return this.$errorToast("Unable to identify domain to delete.");axios.delete(this.$route("landlord.admin.api.tenants.domains.destroy",{tenant:this.tenant.id,domain:this.domainToDelete.id})).then(n=>{this.$successToast("Domain successfully deleted."),this.showDeleteDomainModal=!1,this.tenant.domains.splice(this.domainIndexToDelete,1),this.domainIndexToDelete=null}).catch(n=>{console.log(n),this.$errorToast("Failed to delete domain.")}).finally(()=>{this.isLoadingDomain=!1})},submitAddDomain(){this.isLoadingDomain=!0,axios.post(this.$route("landlord.admin.api.tenants.domains.store",this.tenant.id),this.domainData).then(n=>{this.tenant.domains.push(n.data.data),this.showAddDomainModal=!1,this.$successToast("Successfully added domain: "+n.data.data.domain)}).catch(n=>{var e,a;let t="Failed to create domain, please try again";(a=(e=n==null?void 0:n.response)==null?void 0:e.data)!=null&&a.message&&(t=n.response.data.message),this.$errorToast(t)}).finally(()=>{this.isLoadingDomain=!1})},submit(){this.$inertia.put(this.$route("landlord.admin.tenants`.update",this.user.id),this.formData)}}};var u=function(){var t=this,e=t._self._c;return e("form",{staticClass:"max-w-5xl mx-auto",attrs:{autocomplete:"off"},on:{submit:function(a){return a.preventDefault(),t.submit.apply(null,arguments)}}},[t.userCan("tenants.edit")?e("div",{staticClass:"flex flex-row items-center mb-6"},[e("h1",{staticClass:"font-medium mr-auto text-lg"},[t._v(" Edit Tenant "),e("span",{staticClass:"ml-2 opacity-75 text-sm"},[t._v(" "+t._s(t.tenant.id)+" ")])]),t.userCan("tenants.view")?e("inertia-link",{staticClass:"button button-default-responsive button-primary-subtle flex flex-row items-center mr-2",attrs:{href:t.$route("landlord.admin.tenants.index")}},[e("icon-chevron-left",{staticClass:"w-5 md:mr-2"}),e("span",{staticClass:"hidden md:inline"},[t._v(" Back ")])],1):t._e(),e("button",{staticClass:"button button-default-responsive button-primary flex flex-row items-center",attrs:{type:"submit"}},[e("icon-save",{staticClass:"w-5 md:mr-2"}),e("span",{staticClass:"hidden md:inline"},[t._v(" Save Changes ")])],1)],1):t._e(),e("div",{staticClass:"bg-white py-6 shadow-subtle rounded-lg"},[e("div",{staticClass:"block px-6 w-full"},[e("input-group",{attrs:{"error-message":t.getPageErrorMessage("id"),"input-autocomplete":"off","input-autofocus":!0,"input-id":"id","input-name":"id","input-required":!0,"input-type":"text","label-text":"ID"},on:{errorHidden:function(a){return t.clearPageErrorMessage("id")}},model:{value:t.formData.id,callback:function(a){t.$set(t.formData,"id",a)},expression:"formData.id"}}),e("input-group",{staticClass:"mt-4",attrs:{"input-autocomplete":"off","input-disabled":!0,"input-id":"tenancy_db_name","input-name":"tenancy_db_name","input-type":"text","label-text":"DB Name"},model:{value:t.tenant.tenancy_db_name,callback:function(a){t.$set(t.tenant,"tenancy_db_name",a)},expression:"tenant.tenancy_db_name"}})],1)]),e("div",{staticClass:"bg-white mt-6 py-6 shadow-subtle rounded-lg"},[e("div",{staticClass:"block px-6 w-full"},[e("div",{staticClass:"flex flex-row items-center mb-4"},[e("span",{staticClass:"font-medium text-theme-base-contrast tracking-wider"},[t._v(" Domains ")]),e("button",{staticClass:"button button-primary-subtle button-small ml-auto text-sm",attrs:{type:"button"},on:{click:t.addDomain}},[t._v(" Add Domain ")])]),t.tenant.domains.length?e("div",{staticClass:"space-y-3"},t._l(t.tenant.domains,function(a,o){return e("div",{key:`domain-${a.domain}`},[e("div",{staticClass:"border-2 border-theme-base-subtle flex flex-row items-center py-1 rounded"},[e("span",{staticClass:"font-semibold ml-4 mr-auto"},[t._v(" "+t._s(a.domain)+" ")]),e("button",{staticClass:"flex flex-row items-center inline-flex mx-1 px-2 py-1 rounded text-theme-base-subtle-contrast text-sm tracking-wide focus:outline-none focus:ring hover:bg-theme-danger hover:text-theme-danger-contrast",attrs:{title:"Delete Menu Item",type:"button"},on:{click:function(f){return t.checkDomainDelete(o)}}},[e("icon-trash",{staticClass:"w-4"})],1)])])}),0):e("p",{staticClass:"bg-theme-base-subtle mt-6 px-4 py-3 rounded text-center text-theme-base-subtle-contrast"},[t._v(" No domains ")])])]),e("generic-modal",{attrs:{"show-modal":t.showAddDomainModal},on:{closeModal:t.closeAddDomainModal}},[t.showAddDomainModal?e("form",{staticClass:"mx-6 mb-6",attrs:{autocomplete:"off"},on:{submit:function(a){return a.preventDefault(),a.stopPropagation(),t.submitAddDomain.apply(null,arguments)}}},[e("input-group",{attrs:{"error-message":t.getPageErrorMessage("domain"),"input-autocomplete":"off","input-autofocus":!0,"input-disabled":t.isLoadingDomain,"input-id":"domain","input-name":"domain","input-required":!0,"input-type":"text","label-text":"Domain"},on:{errorHidden:function(a){return t.clearPageErrorMessage("domain")}},model:{value:t.domainData.domain,callback:function(a){t.$set(t.domainData,"domain",a)},expression:"domainData.domain"}}),e("div",{staticClass:"flex flex-row justify-end"},[e("button",{staticClass:"button button-default-responsive button-primary button-small mt-4 flex flex-row items-center",attrs:{disabled:t.isLoadingDomain,type:"submit"}},[t._v(" Add Domain ")])])],1):t._e()]),e("confirmation-modal",{attrs:{"confirm-text":"Delete","confirm-type":"danger","show-modal":t.showDeleteDomainModal,"message-text":t.deleteDomainModalText},on:{cancelAction:t.cancelDomainDelete,closeModal:t.cancelDomainDelete,confirmAction:t.confirmDomainDelete}})],1)},c=[],p=r(m,u,c,!1,null,null,null,null);const _=p.exports;export{_ as default};
