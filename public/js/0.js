(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{lN98:function(e,t,i){"use strict";const r=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],n=["B","kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],s=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],a=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],o=(e,t)=>{let i=e;return"string"==typeof t?i=e.toLocaleString(t):!0===t&&(i=e.toLocaleString()),i};e.exports=(e,t)=>{if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);const i=(t=Object.assign({bits:!1,binary:!1},t)).bits?t.binary?a:s:t.binary?n:r;if(t.signed&&0===e)return" 0 "+i[0];const c=e<0,l=c?"-":t.signed?"+":"";if(c&&(e=-e),e<1){return l+o(e,t.locale)+" "+i[0]}const u=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),i.length-1);e=Number((e/Math.pow(t.binary?1024:1e3,u)).toPrecision(3));return l+o(e,t.locale)+" "+i[u]}},qQAs:function(e,t,i){"use strict";i.r(t);var r=i("LvDl"),n=i.n(r),s={name:"FileManagerDirectoryList",props:{canChangeDirectory:{default:!1,type:Boolean},directories:{required:!0,type:Array},isLoadingDirectories:{default:!1,type:Boolean},parentDirectory:{required:!0,type:null|String}},methods:{changeDirectory:function(e){this.$emit("changeDirectory",e)}}},a=i("KHd+"),o=Object(a.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",[e.isLoadingDirectories?[i("li",{staticClass:"flex flex-row items-start text-gray-500 py-1 w-full"},[i("icon-loader-circle",{staticClass:"animate-spin-slow mr-2 w-5"}),e._v(" "),i("span",[e._v("Loading")])],1)]:[null!==e.parentDirectory?i("li",[i("button",{staticClass:"\n                    flex flex-row items-start py-1 w-full\n                    focus:outline-none focus:text-theme-primary\n                    hover:text-theme-primary\n                ",attrs:{disabled:!e.canChangeDirectory,type:"button"},on:{click:function(t){return e.changeDirectory(e.parentDirectory)}}},[i("icon-arrow-bar-up",{staticClass:"mr-2 w-5"}),e._v(" "),i("span",[e._v("Parent Directory")])],1)]):e._e(),e._v(" "),e._l(e.directories,(function(t){return i("li",{key:t.directory},[i("button",{staticClass:"\n                    flex flex-row items-start py-1 w-full\n                    focus:outline-none focus:text-theme-primary\n                    hover:text-theme-primary\n                ",attrs:{type:"button",disabled:!e.canChangeDirectory},on:{click:function(i){return e.changeDirectory(t.directory)}}},[i("icon-folder",{staticClass:"mr-2 w-5"}),e._v(" "),i("span",[e._v(e._s(t.label))])],1)])}))]],2)}),[],!1,null,null,null).exports,c={name:"FileManagerFilesHeader",props:{canChangeDirectory:{default:!1,type:Boolean},currentDirectoryList:{required:!0,type:Array},showBreadcrumbs:{default:!1,type:Boolean}},methods:{changeDirectoryViaBreadcrumb:function(e){this.$emit("changeDirectoryViaBreadcrumb",e)}}},l=Object(a.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("h2",{staticClass:"flex flex-row items-center justify-between"},[i("span",{staticClass:"text-gray-500"},[e._v("\n        Files\n    ")]),e._v(" "),e.showBreadcrumbs?i("span",{staticClass:"flex flex-row space-x-2 text-sm"},e._l(e.currentDirectoryList,(function(t,r){return i("span",{key:"breadcrumb_"+r,staticClass:"flex flex-row"},[r<e.currentDirectoryList.length-1?[i("button",{staticClass:"\n                        text-gray-500\n                        focus:outline-none focus:text-theme-primary\n                        hover:text-theme-primary\n                    ",attrs:{type:"button",disabled:!e.canChangeDirectory},on:{click:function(t){return e.changeDirectoryViaBreadcrumb(r)}}},[0===r?[e._v("\n                        root\n                    ")]:[e._v("\n                        "+e._s(t)+"\n                    ")]],2),e._v(" "),i("span",{staticClass:"ml-2 text-gray-300"},[e._v("\n                    /\n                ")])]:[i("span",{staticClass:"text-gray-500",class:{"opacity-50":!e.canChangeDirectory}},[e._v("\n                    "+e._s(t)+"\n                ")])]],2)})),0):e._e()])}),[],!1,null,null,null).exports,u=i("lN98"),f=i.n(u),d=i("b5oN"),h=(i("0EnR"),i("wK6g")),y={name:"FileManagerFilesListFile",components:{IconInfoSquare:i("d1pi").default,IconExternalLink:h.default},props:{file:{required:!0,type:Object}},computed:{etag:function(){return this.file.meta.etag.split('"').join("")},fileDropdownMeta:function(){var e={};return this.fileUpdatedAt&&(e["Last Updated"]=this.fileUpdatedAt),this.fileSize&&(e.Size=this.fileSize),this.fileExtension&&(e["File Extension"]=this.fileExtension),this.file.url&&(e.URL=this.file.url),e},fileExtension:function(){try{return this.file.meta.extension}catch(e){return!1}},fileIcon:function(){try{switch(this.file.meta.mimetype.toLowerCase()){case"image/jpeg":case"image/png":return"icon-photo";case"application/pdf":case"text/plain":return"icon-file-text";default:return"icon-file"}}catch(e){return"icon-file"}},fileSize:function(){try{return f()(this.file.meta.size)}catch(e){return!1}},fileUpdatedAt:function(){try{return new Date(this.file.meta.timestamp).toLocaleString()}catch(e){return!1}},infoButtonId:function(){return"info-button-"+this.etag},isFileDropdownMeta:function(){try{return Object.keys(this.fileDropdownMeta).length}catch(e){return!1}}},mounted:function(){this.initialiseFileDropdown()},methods:{initialiseFileDropdown:function(){if(this.isFileDropdownMeta){var e=this.$refs.infoDropdownMenu;e.style.display="block",Object(d.a)("#"+this.infoButtonId,{animation:"shift-away-extreme",content:e,interactive:!0,placement:"bottom-end",theme:"dropdown",trigger:"click"})}}}},m={name:"FileManagerFilesList",components:{FileManagerFilesListFile:Object(a.a)(y,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{staticClass:"\n        flex flex-row items-start justify-between py-2 space-x-4\n        ease-in-out duration-300 transition-colors\n        hover:bg-gray-100\n    "},[i("div",{staticClass:"flex flex-row items-start"},[i(e.fileIcon,{tag:"component",staticClass:"min-w-5 mr-2 w-5"}),e._v(" "),i("span",[e._v(e._s(e.file.meta.basename))])],1),e._v(" "),i("div",{staticClass:"flex flex-row items-center space-x-2"},[e.file.url?i("a",{staticClass:"\n                flex flex-row items-center justify-center rounded text-gray-500\n                ease-in-out duration-300 transition-colors\n                focus:outline-none\n                hover:text-theme-primary\n            ",attrs:{href:e.file.url,rel:"noreferrer noopener nofollow",target:"_blank"}},[i("icon-external-link",{staticClass:"w-5"})],1):e._e(),e._v(" "),e.isFileDropdownMeta?i("button",{staticClass:"\n                flex flex-row items-center justify-center rounded text-gray-500\n                ease-in-out duration-300 transition-colors\n                focus:outline-none\n                hover:text-theme-primary\n            ",attrs:{id:e.infoButtonId,type:"button"}},[i("icon-info-square",{staticClass:"w-5"})],1):e._e(),e._v(" "),e.isFileDropdownMeta?i("div",{ref:"infoDropdownMenu",staticClass:"\n                flex flex-col px-4 py-4 space-y-3\n                focus:outline-none\n            "},e._l(e.fileDropdownMeta,(function(t,r){return i("p",{key:r},[i("span",{staticClass:"block text-gray-500 text-xs"},[e._v("\n                    "+e._s(r)+"\n                ")]),e._v(" "),i("span",{staticClass:"block break-all text-gray-700 text-sm"},[e._v("\n                    "+e._s(t)+"\n                ")])])})),0):e._e()])])}),[],!1,null,null,null).exports},props:{files:{required:!0,type:Array},showFilesLoader:{default:!0,type:Boolean}},computed:{isFiles:function(){return this.files.length}}},g=Object(a.a)(m,(function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[this.showFilesLoader?[t("li",{staticClass:"flex flex-row items-center justify-center text-gray-500 text-sm py-4 w-full"},[t("span",{staticClass:"flex items-center"},[t("icon-loader-circle",{staticClass:"animate-spin-slow mr-2 w-5"}),this._v(" "),t("span",[this._v("Loading")])],1)])]:this.isFiles?this._l(this.files,(function(e){return t("file-manager-files-list-file",{key:e.meta.basename,staticClass:"-mx-6 px-6",attrs:{file:e}})})):[this._m(0)]],2)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("li",{staticClass:"flex flex-row items-center justify-center text-gray-500 text-sm py-4 w-full"},[t("span",[this._v("No files")])])}],!1,null,null,null).exports,p=axios.CancelToken,D=p.source(),w={name:"FileManager",components:{FileManagerFilesList:g,FileManagerFilesHeader:l,FileManagerDirectoryList:o},props:{initialise:{default:!1,type:Boolean}},data:function(){return{currentDirectory:"/",directories:[],files:[],isInitialised:!1,isCreatingDirectory:!1,isLoadingDirectories:!1,isLoadingFiles:!1,isLoadingNewDirectory:!1,newDirectoryName:""}},computed:{canChangeDirectory:function(){return!this.isLoadingNewDirectory&&!this.isLoadingDirectories},canCreateDirectory:function(){return!!this.isCreatingDirectory&&(!this.isLoadingNewDirectory&&!!n.a.trim(this.newDirectoryName).length)},currentDirectoryList:function(){var e=n.a.trim(this.currentDirectory,"/");if(!e)return["/"];var t=n.a.split(e,"/");return["/"].concat(t)},newDirectoryNameFormatted:function(){if(!this.currentDirectoryList||this.currentDirectoryList.length<2)return this.newDirectoryName;var e=n.a.clone(this.currentDirectoryList);return(e=e.splice(1)).push(this.newDirectoryName),"/"+e.join("/")},parentDirectory:function(){return this.currentDirectoryList?1===this.currentDirectoryList.length?null:2===this.currentDirectoryList.length?this.currentDirectoryList[0]:"/"+n.a.clone(this.currentDirectoryList).splice(1,this.currentDirectoryList.length-2).join("/"):null},showBreadcrumbs:function(){return this.currentDirectoryList.length>1},showCreateDirectoryButton:function(){return!this.isLoadingDirectories&&this.userCan("file_manager.edit")},showFilesLoader:function(){return this.isLoadingDirectories||this.isLoadingFiles}},mounted:function(){this.initialise&&this.initialiseFileManager()},methods:{cancelLoadFiles:function(){this.isLoadingFiles&&(D.cancel("Files load cancelled"),D=p.source())},changeDirectory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";this.canChangeDirectory?(this.currentDirectory=e,this.loadDirectories()):console.error("Unable to change directory.")},changeDirectoryViaBreadcrumb:function(e){if(!(e>this.currentDirectoryList.length-1)){var t=this.getDirectoryViaBreadcrumb(e);t&&this.changeDirectory(t)}},createDirectory:function(){var e=this;if(this.canCreateDirectory){this.isLoadingNewDirectory=!0;var t={directory:this.newDirectoryNameFormatted};axios.post(this.$route("admin.api.file-manager.directories.store"),t).then((function(t){e.isLoadingNewDirectory=!1,e.changeDirectory(e.newDirectoryNameFormatted),e.stopCreatingDirectory()})).catch((function(t){e.isLoadingNewDirectory=!1,console.error(t)}))}else console.error("Please enter a valid directory name")},getDirectoryViaBreadcrumb:function(e){if(0===e)return"/";var t=n.a.clone(this.currentDirectoryList);return"/"+(t=t.splice(1,e)).join("/")},initialiseFileManager:function(){this.isInitialised||(this.isInitialised=!0,this.loadFileManager())},loadDirectories:function(){var e=this;if(!this.isLoadingDirectories){this.isLoadingDirectories=!0,this.directories=[],this.cancelLoadFiles();var t={directory:this.currentDirectory};axios.get(this.$route("admin.api.file-manager.directories.index"),{params:t}).then((function(t){t.data.hasOwnProperty("directories")&&(e.directories=t.data.directories),e.loadFiles()})).catch((function(e){console.error(e)})).finally((function(){e.isLoadingDirectories=!1}))}},loadFileManager:function(){this.loadDirectories()},loadFiles:function(){var e=this;if(!this.isLoadingFiles){this.isLoadingFiles=!0,this.files=[];var t={directory:this.currentDirectory};axios.get(this.$route("admin.api.file-manager.files.index"),{params:t,cancelToken:D.token}).then((function(t){t.data.hasOwnProperty("files")&&(e.files=t.data.files)})).catch((function(e){axios.isCancel(e)||console.error(e)})).finally((function(){e.isLoadingFiles=!1}))}},onInitialise:function(){this.initialise&&this.initialiseFileManager()},startCreatingDirectory:function(){var e=this;this.newDirectoryName="",this.isCreatingDirectory=!0;try{setTimeout((function(){e.$refs.new_directory.focus()}),350)}catch(e){}},stopCreatingDirectory:function(){if(this.isCreatingDirectory){if(this.isLoadingNewDirectory)return!1;this.newDirectoryName="",this.isCreatingDirectory=!1;try{this.$refs.new_directory.blur()}catch(e){}}}},watch:{initialise:{handler:"onInitialise"}}},x={name:"AdminFileManagerIndex",components:{FileManager:Object(a.a)(w,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",[i("div",{staticClass:"\n            flex flex-col mt-4 space-y-4\n            md:flex-row md:items-start md:space-x-4 md:space-y-0\n        "},[i("div",{staticClass:"\n                bg-white p-6 shadow-subtle overflow-hidden rounded-lg\n                md:w-72\n            "},[e._m(0),e._v(" "),i("div",{staticClass:"mt-2"},[i("file-manager-directory-list",{attrs:{canChangeDirectory:e.canChangeDirectory,directories:e.directories,isLoadingDirectories:e.isLoadingDirectories,parentDirectory:e.parentDirectory},on:{changeDirectory:e.changeDirectory}}),e._v(" "),e.showCreateDirectoryButton?i("div",{staticClass:"mt-8 w-full"},[i("transition",{attrs:{name:"slide-left",mode:"out-in"}},[e.isCreatingDirectory?i("div",{key:"creating",staticClass:"flex flex-col"},[i("label",{attrs:{for:"new_directory",hidden:""}},[e._v("\n                                New Directory Name\n                            ")]),e._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.newDirectoryName,expression:"newDirectoryName"}],ref:"new_directory",staticClass:"border border-gray-500 px-4 py-1 rounded",attrs:{id:"new_directory",placeholder:"Directory Name",type:"text"},domProps:{value:e.newDirectoryName},on:{input:function(t){t.target.composing||(e.newDirectoryName=t.target.value)}}}),e._v(" "),i("div",{staticClass:"flex flex-row mt-2 space-x-2 w-full"},[i("button",{staticClass:"\n                                        border border-gray-500 flex flex-row items-center justify-center px-2 py-1 rounded text-gray-500 w-1/2\n                                        ease-in-out duration-300 transition-colors\n                                        focus:bg-theme-danger focus:border-theme-danger focus:outline-none focus:text-theme-danger-contrast\n                                        hover:bg-theme-danger hover:border-theme-danger hover:text-theme-danger-contrast\n                                    ",attrs:{type:"button",disabled:e.isLoadingNewDirectory},on:{click:e.stopCreatingDirectory}},[i("icon-x",{staticClass:"w-5"})],1),e._v(" "),i("button",{staticClass:"\n                                        border border-theme-success flex flex-row items-center justify-center px-2 py-1 rounded text-theme-success w-1/2\n                                        ease-in-out duration-300 transition-colors\n                                        focus:outline-none focus:bg-theme-success focus:text-theme-success-contrast\n                                        hover:bg-theme-success hover:border-theme-success hover:text-theme-success-contrast\n                                    ",attrs:{type:"button",disabled:!e.canCreateDirectory},on:{click:e.createDirectory}},[e.isLoadingNewDirectory?i("icon-loader-circle",{staticClass:"animate-spin-slow w-5"}):i("icon-check",{staticClass:"w-5"})],1)])]):i("button",{key:"intial",staticClass:"\n                                border border-gray-500 flex flex-row items-center justify-center px-2 py-1 rounded text-gray-500 w-full\n                                ease-in-out duration-300 transition-colors\n                                focus:border-theme-primary focus:outline-none\n                                hover:bg-theme-primary hover:border-theme-primary hover:text-theme-primary-contrast\n                            ",attrs:{type:"button"},on:{click:e.startCreatingDirectory}},[e._v("\n                            Create Directory\n                        ")])])],1):e._e()],1)]),e._v(" "),i("div",{staticClass:"bg-white flex-1 p-6 shadow-subtle rounded-lg"},[i("file-manager-files-header",{attrs:{canChangeDirectory:e.canChangeDirectory,currentDirectoryList:e.currentDirectoryList,showBreadcrumbs:e.showBreadcrumbs},on:{changeDirectoryViaBreadcrumb:e.changeDirectoryViaBreadcrumb}}),e._v(" "),i("file-manager-files-list",{staticClass:"mt-2",attrs:{files:e.files,showFilesLoader:e.showFilesLoader}})],1)])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{staticClass:"flex flex-row justify-between"},[t("span",{staticClass:"text-gray-500"},[this._v("\n                    Directories\n                ")])])}],!1,null,null,null).exports},layout:"admin-layout"},b=Object(a.a)(x,(function(){var e=this.$createElement,t=this._self._c||e;return t("section",{staticClass:"container mx-auto"},[this._m(0),this._v(" "),t("file-manager",{attrs:{initialise:!0}})],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"\n            page-header\n            mb-6 text-lg\n        "},[t("h1",[this._v("File Manager")])])}],!1,null,null,null);t.default=b.exports}}]);