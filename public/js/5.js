(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{qQAs:function(t,e,r){"use strict";r.r(e);var i=r("LvDl"),n=r.n(i),s={name:"FileManager",props:{initialise:{default:!1,type:Boolean}},data:function(){return{currentDirectory:"/",directories:[],isInitialised:!1,isCreatingDirectory:!1,isLoadingDirectories:!1,isLoadingFiles:!1,isLoadingNewDirectory:!1,newDirectoryName:""}},computed:{canChangeDirectory:function(){return!this.isLoadingNewDirectory&&!this.isLoadingDirectories},canCreateDirectory:function(){return!!this.isCreatingDirectory&&(!this.isLoadingNewDirectory&&!!n.a.trim(this.newDirectoryName).length)},currentDirectoryList:function(){var t=n.a.trim(this.currentDirectory,"/");if(!t)return["/"];var e=n.a.split(t,"/");return["/"].concat(e)},newDirectoryNameFormatted:function(){if(!this.currentDirectoryList||this.currentDirectoryList.length<2)return this.newDirectoryName;var t=n.a.clone(this.currentDirectoryList);return(t=t.splice(1)).push(this.newDirectoryName),"/"+t.join("/")},parentDirectory:function(){return this.currentDirectoryList?1===this.currentDirectoryList.length?null:2===this.currentDirectoryList.length?this.currentDirectoryList[0]:"/"+n.a.clone(this.currentDirectoryList).splice(1,this.currentDirectoryList.length-2).join("/"):null},showBreadcrumbs:function(){return this.currentDirectoryList.length>1},showCreateDirectoryButton:function(){return!this.isLoadingDirectories&&this.userCan("file_manager.edit")}},mounted:function(){this.initialise&&this.initialiseFileManager()},methods:{changeDirectory:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";this.canChangeDirectory?(this.currentDirectory=t,this.loadDirectories()):console.log("Unable to change directory.")},changeDirectoryViaBreadcrumb:function(t){if(!(t>this.currentDirectoryList.length-1)){var e=this.getDirectoryViaBreadcrumb(t);e&&this.changeDirectory(e)}},createDirectory:function(){var t=this;if(this.canCreateDirectory){this.isLoadingNewDirectory=!0;var e={directory:this.newDirectoryNameFormatted};axios.post(this.$route("admin.api.file-manager.directories.store"),e).then((function(e){t.isLoadingNewDirectory=!1,t.changeDirectory(t.newDirectoryNameFormatted),t.stopCreatingDirectory()})).catch((function(e){t.isLoadingNewDirectory=!1,console.log(e)}))}else console.error("Please enter a valid directory name")},getDirectoryViaBreadcrumb:function(t){if(0===t)return"/";var e=n.a.clone(this.currentDirectoryList);return"/"+(e=e.splice(1,t)).join("/")},initialiseFileManager:function(){this.isInitialised||(this.isInitialised=!0,this.loadFileManager())},loadDirectories:function(){var t=this;if(!this.isLoadingDirectories){this.isLoadingDirectories=!0;var e={directory:this.currentDirectory};axios.get(this.$route("admin.api.file-manager.directories.index"),{params:e}).then((function(e){e.data.hasOwnProperty("directories")&&(t.directories=e.data.directories)})).catch((function(t){console.log(t)})).finally((function(){t.isLoadingDirectories=!1}))}},loadFileManager:function(){this.loadDirectories(),this.loadFiles()},loadFiles:function(){},onInitialise:function(){this.initialise&&this.initialiseFileManager()},startCreatingDirectory:function(){var t=this;this.newDirectoryName="",this.isCreatingDirectory=!0;try{setTimeout((function(){t.$refs.new_directory.focus()}),350)}catch(t){}},stopCreatingDirectory:function(){if(this.isCreatingDirectory){if(this.isLoadingNewDirectory)return!1;this.newDirectoryName="",this.isCreatingDirectory=!1;try{this.$refs.new_directory.blur()}catch(t){}}}},watch:{initialise:{handler:"onInitialise"}}},o=r("KHd+"),a={name:"AdminFileManagerIndex",components:{FileManager:Object(o.a)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",[r("div",{staticClass:"\n            flex flex-col mt-4 space-y-4\n            md:flex-row md:items-start md:space-x-4 md:space-y-0\n        "},[r("div",{staticClass:"\n                bg-white p-6 shadow-subtle overflow-hidden rounded-lg\n                md:w-72\n            "},[t._m(0),t._v(" "),r("div",{staticClass:"mt-2"},[r("ul",[t.isLoadingDirectories?[r("li",{staticClass:"flex flex-row items-start text-gray-500 py-1 w-full"},[r("icon-loader-circle",{staticClass:"animate-spin-slow mr-2 w-5"}),t._v(" "),r("span",[t._v("Loading")])],1)]:[null!==t.parentDirectory?r("li",[r("button",{staticClass:"\n                                    flex flex-row items-start py-1 w-full\n                                    focus:outline-none focus:text-theme-primary\n                                    hover:text-theme-primary\n                                ",attrs:{disabled:!t.canChangeDirectory,type:"button"},on:{click:function(e){return t.changeDirectory(t.parentDirectory)}}},[r("icon-arrow-bar-up",{staticClass:"mr-2 w-5"}),t._v(" "),r("span",[t._v("Parent Directory")])],1)]):t._e(),t._v(" "),t._l(t.directories,(function(e){return r("li",{key:e.directory},[r("button",{staticClass:"\n                                    flex flex-row items-start py-1 w-full\n                                    focus:outline-none focus:text-theme-primary\n                                    hover:text-theme-primary\n                                ",attrs:{type:"button",disabled:!t.canChangeDirectory},on:{click:function(r){return t.changeDirectory(e.directory)}}},[r("icon-folder",{staticClass:"mr-2 w-5"}),t._v(" "),r("span",[t._v(t._s(e.label))])],1)])}))]],2),t._v(" "),t.showCreateDirectoryButton?r("div",{staticClass:"mt-8 w-full"},[r("transition",{attrs:{name:"slide-left",mode:"out-in"}},[t.isCreatingDirectory?r("div",{key:"creating",staticClass:"flex flex-col"},[r("label",{attrs:{for:"new_directory",hidden:""}},[t._v("\n                                New Directory Name\n                            ")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.newDirectoryName,expression:"newDirectoryName"}],ref:"new_directory",staticClass:"border border-gray-500 px-4 py-1 rounded",attrs:{id:"new_directory",placeholder:"Directory Name",type:"text"},domProps:{value:t.newDirectoryName},on:{input:function(e){e.target.composing||(t.newDirectoryName=e.target.value)}}}),t._v(" "),r("div",{staticClass:"flex flex-row mt-2 space-x-2 w-full"},[r("button",{staticClass:"\n                                        border border-gray-500 flex flex-row items-center justify-center px-2 py-1 rounded text-gray-500 w-1/2\n                                        ease-in-out duration-300 transition-colors\n                                        focus:bg-theme-danger focus:border-theme-danger focus:outline-none focus:text-theme-danger-contrast\n                                        hover:bg-theme-danger hover:border-theme-danger hover:text-theme-danger-contrast\n                                    ",attrs:{type:"button",disabled:t.isLoadingNewDirectory},on:{click:t.stopCreatingDirectory}},[r("icon-x",{staticClass:"w-5"})],1),t._v(" "),r("button",{staticClass:"\n                                        border border-theme-success flex flex-row items-center justify-center px-2 py-1 rounded text-theme-success w-1/2\n                                        ease-in-out duration-300 transition-colors\n                                        focus:outline-none focus:bg-theme-success focus:text-theme-success-contrast\n                                        hover:bg-theme-success hover:border-theme-success hover:text-theme-success-contrast\n                                    ",attrs:{type:"button",disabled:!t.canCreateDirectory},on:{click:t.createDirectory}},[t.isLoadingNewDirectory?r("icon-loader-circle",{staticClass:"animate-spin-slow w-5"}):r("icon-check",{staticClass:"w-5"})],1)])]):r("button",{key:"intial",staticClass:"\n                                border border-gray-500 flex flex-row items-center justify-center px-2 py-1 rounded text-gray-500 w-full\n                                ease-in-out duration-300 transition-colors\n                                focus:border-theme-primary focus:outline-none\n                                hover:bg-theme-primary hover:border-theme-primary hover:text-theme-primary-contrast\n                            ",attrs:{type:"button"},on:{click:t.startCreatingDirectory}},[t._v("\n                            Create Directory\n                        ")])])],1):t._e()])]),t._v(" "),r("div",{staticClass:"bg-white flex-1 p-6 shadow-subtle rounded-lg"},[r("h2",{staticClass:"flex flex-row items-center justify-between"},[r("span",{staticClass:"text-gray-500"},[t._v("\n                    Files\n                ")]),t._v(" "),t.showBreadcrumbs?r("span",{staticClass:"flex flex-row space-x-2 text-sm"},t._l(t.currentDirectoryList,(function(e,i){return r("span",{key:"breadcrumb_"+i,staticClass:"flex flex-row"},[i<t.currentDirectoryList.length-1?[r("button",{staticClass:"\n                                text-gray-500\n                                focus:outline-none focus:text-theme-primary\n                                hover:text-theme-primary\n                            ",attrs:{type:"button",disabled:!t.canChangeDirectory},on:{click:function(e){return t.changeDirectoryViaBreadcrumb(i)}}},[0===i?[t._v("\n                                    root\n                                ")]:[t._v("\n                                    "+t._s(e)+"\n                                ")]],2),t._v(" "),r("span",{staticClass:"ml-2 text-gray-300"},[t._v("\n                                /\n                            ")])]:[r("span",{staticClass:"text-gray-500",class:{"opacity-50":!t.canChangeDirectory}},[t._v("\n                                "+t._s(e)+"\n                            ")])]],2)})),0):t._e()]),t._v(" "),r("div",{staticClass:"mt-2"})])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{staticClass:"flex flex-row justify-between"},[e("span",{staticClass:"text-gray-500"},[this._v("\n                    Directories\n                ")])])}],!1,null,null,null).exports},layout:"admin-layout"},c=Object(o.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"container mx-auto"},[this._m(0),this._v(" "),e("file-manager",{attrs:{initialise:!0}})],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"\n            page-header\n            mb-6 text-lg\n        "},[e("h1",[this._v("File Manager")])])}],!1,null,null,null);e.default=c.exports}}]);