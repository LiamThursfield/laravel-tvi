"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[295],{9295:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var n=a(1304),s=a.n(n),l=a(8825),i=a(3195),o=axios.CancelToken,u=o.source();const r={name:"AdminCmsLayoutCreate",components:{InputGroup:l.Z,SelectGroup:i.Z},layout:"admin-layout",props:{templates:{type:Object|Array,required:!0}},data:function(){return{autoUpdateSlug:!0,formData:{name:"",slug:"",template_id:""},isLoadingTemplate:!1,selectedTemplate:null}},computed:{isTemplates:function(){try{return Object.keys(this.templates).length}catch(e){return!1}},selectedTemplateHasFields:function(){try{return!!this.selectedTemplate&&this.selectedTemplate.template_fields.length}catch(e){return!1}},selectedTemplateId:function(){var e;return null!==(e=this.formData.template_id)&&void 0!==e?e:""}},methods:{cancelLoadTemplate:function(){this.isLoadingTemplate&&(u.cancel("Template load cancelled"),u=o.source())},onNameInput:function(){this.autoUpdateSlug&&(this.formData.slug=this.slugify(this.formData.name))},onSelectedTemplateIdChange:_.debounce((function(){var e=this;this.selectedTemplate=null,this.cancelLoadTemplate(),this.selectedTemplateId&&(this.isLoadingTemplate=!0,axios.get(this.$route("admin.api.cms.templates.show",this.selectedTemplateId)).then((function(t){e.selectedTemplate=_.cloneDeep(t.data.data),e.setNewTemplateContent()})).catch((function(t){axios.isCancel(t)||(e.$errorToast("Failed to load selected template"),console.log(t))})).finally((function(){e.isLoadingTemplate=!1})))}),500),onSlugBlur:function(){this.formData.slug=this.slugify(this.formData.slug)},onSlugInput:function(){this.autoUpdateSlug=!1},setNewTemplateContent:function(){this.selectedTemplateHasFields||(this.formData.content={});var e={};_.forEach(this.selectedTemplate.template_fields,(function(t){e[t.id]={data:"",template_field_id:t.id}})),this.$set(this.formData,"content",_.cloneDeep(e))},slugify:function(e){return e&&e.length?s()(e,{lower:!0}):""},submit:function(){this.$inertia.post(this.$route("admin.cms.layouts.store"),this.formData)}},watch:{selectedTemplateId:{handler:"onSelectedTemplateIdChange"}}};const m=(0,a(1900).Z)(r,(function(){var e=this,t=e._self._c;return t("form",{staticClass:"max-w-5xl mx-auto",attrs:{autocomplete:"off"},on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[e.userCan("cms_advanced.create")?t("div",{staticClass:"flex flex-row items-center mb-6"},[t("h1",{staticClass:"font-medium mr-auto text-lg"},[e._v("\n            Create Layout\n        ")]),e._v(" "),e.userCan("cms_advanced.view")?t("inertia-link",{staticClass:"button button-default-responsive button-primary-subtle flex flex-row items-center mr-2",attrs:{href:e.$route("admin.cms.layouts.index")}},[t("icon-chevron-left",{staticClass:"w-5 md:mr-2"}),e._v(" "),t("span",{staticClass:"hidden md:inline"},[e._v("\n                Back\n            ")])],1):e._e(),e._v(" "),t("button",{staticClass:"button button-default-responsive button-primary flex flex-row items-center",attrs:{type:"submit"}},[t("icon-save",{staticClass:"w-5 md:mr-2"}),e._v(" "),t("span",{staticClass:"hidden md:inline"},[e._v("\n                Create Layout\n            ")])],1)],1):e._e(),e._v(" "),t("div",{staticClass:"bg-white py-6 shadow-subtle rounded-lg"},[t("div",{staticClass:"block px-6 w-full"},[t("select-group",{attrs:{"error-message":e.getPageErrorMessage("template_id"),"label-text":"Template","input-any-option-enabled":!0,"input-any-option-label":"Please select a template","input-autofocus":!0,"input-id":"template_id","input-name":"template_id","input-options":e.isTemplates?e.templates:{},"input-option-label-key":"name","input-option-value-key":"id","input-required":!0},on:{errorHidden:function(t){return e.clearPageErrorMessage("template_id")}},model:{value:e.formData.template_id,callback:function(t){e.$set(e.formData,"template_id",t)},expression:"formData.template_id"}}),e._v(" "),t("input-group",{staticClass:"mt-4",attrs:{"error-message":e.getPageErrorMessage("name"),"input-autocomplete":"layout_name","input-id":"name","input-name":"name","input-required":!0,"input-type":"text","label-text":"Layout Name"},on:{errorHidden:function(t){return e.clearPageErrorMessage("name")},input:e.onNameInput},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}}),e._v(" "),t("input-group",{staticClass:"mt-4",attrs:{"error-message":e.getPageErrorMessage("slug"),"input-autocomplete":"layout_slug","input-id":"slug","input-name":"slug","input-required":!0,"input-type":"text","label-text":"Layout Slug"},on:{blur:e.onSlugBlur,errorHidden:function(t){return e.clearPageErrorMessage("slug")},input:e.onSlugInput},model:{value:e.formData.slug,callback:function(t){e.$set(e.formData,"slug",t)},expression:"formData.slug"}})],1)]),e._v(" "),!this.isLoadingTemplate&&e.selectedTemplateHasFields?t("div",{staticClass:"bg-white mt-6 px-4 py-6 shadow-subtle rounded-lg"},[t("p",{staticClass:"text-lg"},[e._v("Fields")]),e._v(" "),t("content-editor",{staticClass:"mt-4",attrs:{"template-fields":e.selectedTemplate.template_fields},model:{value:e.formData.content,callback:function(t){e.$set(e.formData,"content",t)},expression:"formData.content"}})],1):e._e()])}),[],!1,null,null,null).exports}}]);